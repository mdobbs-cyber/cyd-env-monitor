# Simple font and icon helper for MicroPython
# Each character is a 6-pixel wide bitmap (columns)
_font = {
    '0': [0x3e, 0x51, 0x49, 0x45, 0x3e, 0x00],
    '1': [0x00, 0x42, 0x7f, 0x40, 0x00, 0x00],
    '2': [0x42, 0x61, 0x51, 0x49, 0x46, 0x00],
    '3': [0x21, 0x41, 0x45, 0x4b, 0x31, 0x00],
    '4': [0x18, 0x14, 0x12, 0x7f, 0x10, 0x00],
    '5': [0x27, 0x45, 0x45, 0x45, 0x39, 0x00],
    '6': [0x3c, 0x4a, 0x49, 0x49, 0x30, 0x00],
    '7': [0x01, 0x71, 0x09, 0x05, 0x03, 0x00],
    '8': [0x36, 0x49, 0x49, 0x49, 0x36, 0x00],
    '9': [0x06, 0x49, 0x49, 0x29, 0x1e, 0x00],
    ':': [0x00, 0x36, 0x36, 0x00, 0x00, 0x00],
    '.': [0x00, 0x60, 0x60, 0x00, 0x00, 0x00],
    ' ': [0x00, 0x00, 0x00, 0x00, 0x00, 0x00],
    '-': [0x08, 0x08, 0x08, 0x08, 0x08, 0x00],
    ',': [0x00, 0x60, 0xa0, 0x00, 0x00, 0x00],
    '!': [0x00, 0x00, 0x5f, 0x00, 0x00, 0x00],
    '?': [0x02, 0x01, 0x51, 0x09, 0x06, 0x00],
    'A': [0x7e, 0x11, 0x11, 0x11, 0x7e, 0x00],
    'B': [0x7f, 0x49, 0x49, 0x49, 0x36, 0x00],
    'C': [0x3e, 0x41, 0x41, 0x41, 0x22, 0x00],
    'D': [0x7f, 0x41, 0x41, 0x22, 0x1c, 0x00],
    'E': [0x7f, 0x49, 0x49, 0x49, 0x41, 0x00],
    'F': [0x7f, 0x09, 0x09, 0x09, 0x01, 0x00],
    'G': [0x3e, 0x41, 0x49, 0x49, 0x7a, 0x00],
    'H': [0x7f, 0x08, 0x08, 0x08, 0x7f, 0x00],
    'I': [0x00, 0x41, 0x7f, 0x41, 0x00, 0x00],
    'J': [0x20, 0x40, 0x41, 0x3f, 0x01, 0x00],
    'K': [0x7f, 0x08, 0x14, 0x22, 0x41, 0x00],
    'L': [0x7f, 0x40, 0x40, 0x40, 0x40, 0x00],
    'M': [0x7f, 0x02, 0x0c, 0x02, 0x7f, 0x00],
    'N': [0x7f, 0x04, 0x08, 0x10, 0x7f, 0x00],
    'O': [0x3e, 0x41, 0x41, 0x41, 0x3e, 0x00],
    'P': [0x7f, 0x09, 0x09, 0x09, 0x06, 0x00],
    'Q': [0x3e, 0x41, 0x51, 0x21, 0x5e, 0x00],
    'R': [0x7f, 0x09, 0x19, 0x29, 0x46, 0x00],
    'S': [0x46, 0x49, 0x49, 0x49, 0x31, 0x00],
    'T': [0x01, 0x01, 0x7f, 0x01, 0x01, 0x00],
    'U': [0x3f, 0x40, 0x40, 0x40, 0x3f, 0x00],
    'V': [0x1f, 0x20, 0x40, 0x20, 0x1f, 0x00],
    'W': [0x3f, 0x40, 0x38, 0x40, 0x3f, 0x00],
    'X': [0x63, 0x14, 0x08, 0x14, 0x63, 0x00],
    'Y': [0x07, 0x08, 0x70, 0x08, 0x07, 0x00],
    'Z': [0x61, 0x51, 0x49, 0x45, 0x43, 0x00],
    'a': [0x20, 0x54, 0x54, 0x54, 0x78, 0x00],
    'b': [0x7f, 0x48, 0x44, 0x44, 0x38, 0x00],
    'c': [0x38, 0x44, 0x44, 0x44, 0x20, 0x00],
    'd': [0x38, 0x44, 0x44, 0x48, 0x7f, 0x00],
    'e': [0x38, 0x54, 0x54, 0x54, 0x18, 0x00],
    'f': [0x08, 0x7e, 0x09, 0x01, 0x02, 0x00],
    'g': [0x0c, 0x52, 0x52, 0x52, 0x3e, 0x00],
    'h': [0x7f, 0x08, 0x04, 0x04, 0x78, 0x00],
    'i': [0x00, 0x44, 0x7d, 0x40, 0x00, 0x00],
    'j': [0x20, 0x40, 0x44, 0x3d, 0x00, 0x00],
    'k': [0x7f, 0x10, 0x28, 0x44, 0x00, 0x00],
    'l': [0x00, 0x41, 0x7f, 0x40, 0x00, 0x00],
    'm': [0x7c, 0x04, 0x18, 0x04, 0x78, 0x00],
    'n': [0x7c, 0x08, 0x04, 0x04, 0x78, 0x00],
    'o': [0x38, 0x44, 0x44, 0x44, 0x38, 0x00],
    'p': [0x7c, 0x14, 0x14, 0x14, 0x08, 0x00],
    'q': [0x08, 0x14, 0x14, 0x18, 0x7c, 0x00],
    'r': [0x7c, 0x08, 0x04, 0x04, 0x08, 0x00],
    's': [0x48, 0x54, 0x54, 0x54, 0x20, 0x00],
    't': [0x04, 0x3f, 0x44, 0x40, 0x20, 0x00],
    'u': [0x3c, 0x40, 0x40, 0x20, 0x7c, 0x00],
    'v': [0x1c, 0x20, 0x40, 0x20, 0x1c, 0x00],
    'w': [0x3c, 0x40, 0x30, 0x40, 0x3c, 0x00],
    'x': [0x44, 0x28, 0x10, 0x28, 0x44, 0x00],
    'y': [0x0c, 0x50, 0x50, 0x50, 0x3c, 0x00],
    'z': [0x44, 0x64, 0x54, 0x4c, 0x44, 0x00],
    '%': [0x23, 0x13, 0x08, 0x64, 0x62, 0x00],
}

# Detailed 16x16 Icons
_icons = {
    'clock': [
        0x07e0, 0x1818, 0x2004, 0x4002, 0x4182, 0x8181, 0x8181, 0x81e1,
        0x8181, 0x8181, 0x8181, 0x4002, 0x4002, 0x2004, 0x1818, 0x07e0
    ],
    'molecule': [
        0x0000, 0x03c0, 0x07e0, 0x0e70, 0x0db0, 0x1db8, 0x3ffc, 0x7ffe,
        0x7ffe, 0x3ffc, 0x1db8, 0x0db0, 0x0e70, 0x07e0, 0x03c0, 0x0000
    ],
    'therm': [
        0x0000, 0x01e0, 0x0210, 0x0408, 0x0408, 0x0408, 0x0408, 0x07f8,
        0x0ffc, 0x0ffc, 0x07f8, 0x0408, 0x0408, 0x0210, 0x01e0, 0x0000
    ],
    'drop': [
        0x0000, 0x0080, 0x01c0, 0x03e0, 0x07f0, 0x0ff8, 0x1ffc, 0x3ffe,
        0x3ffe, 0x3ffe, 0x1ffc, 0x0ff8, 0x07f0, 0x03e0, 0x01c0, 0x0000
    ],
    'sun': [
        0x0180, 0x0180, 0x2184, 0x1188, 0x0990, 0x07e0, 0x0ff0, 0x3ffc,
        0x3ffc, 0x0ff0, 0x07e0, 0x0990, 0x1188, 0x2184, 0x0180, 0x0180
    ]
}

def draw_char(display, char, x, y, scale=2, color=0xFFFF):
    if char in _icons:
        data = _icons[char]
        for i, col in enumerate(data):
            for j in range(16):
                if (col >> j) & 1:
                    display.fill_rect(x + i*scale, y + j*scale, scale, scale, color)
        return

    if char not in _font:
        char = char.upper()
    if char not in _font: return
    
    data = _font[char]
    for i, byte in enumerate(data):
        for j in range(8):
            if (byte >> j) & 1:
                display.fill_rect(x + i*scale, y + j*scale, scale, scale, color)

def draw_text(display, text, x, y, scale=2, color=0xFFFF):
    for i, char in enumerate(text):
        draw_char(display, char, x + i*7*scale, y, scale, color)
